<div class="module-container">
    <h2 class="module-title">Calculateur de Puissance de Chauffage</h2>
    
    <div class="module-description">
        <p>Cet outil vous permet d'estimer la puissance de chauffage nécessaire pour maintenir une température confortable dans votre habitation.</p>
    </div>
    
    <form id="chauffage-form" class="module-form">
        <div class="form-group">
            <label for="surface">Surface habitable (m²) :</label>
            <input type="number" id="surface" name="surface" min="1" value="100" required>
        </div>
        
        <div class="form-group">
            <label for="hauteur">Hauteur sous plafond (m) :</label>
            <input type="number" id="hauteur" name="hauteur" min="1" max="6" step="0.1" value="2.5" required>
        </div>
        
        <div class="form-group">
            <label for="isolation">Niveau d'isolation :</label>
            <select id="isolation" name="isolation" required>
                <option value="excellente">Excellente (BBC, RT2012+)</option>
                <option value="bonne" selected>Bonne (RT2005)</option>
                <option value="moyenne">Moyenne (1980-2000)</option>
                <option value="faible">Faible (avant 1980)</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="zone">Zone climatique :</label>
            <select id="zone" name="zone" required>
                <option value="H1" selected>H1 (Nord, Est)</option>
                <option value="H2">H2 (Ouest, Centre)</option>
                <option value="H3">H3 (Sud)</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>Type d'émetteur :</label>
            <div class="radio-group">
                <input type="radio" id="radiateur" name="typeEmetteur" value="radiateur" checked>
                <label for="radiateur">Radiateurs</label>
                
                <input type="radio" id="plancher" name="typeEmetteur" value="plancher">
                <label for="plancher">Plancher chauffant</label>
            </div>
        </div>
        
        <div id="radiateur-params" class="conditional-section">
            <div class="form-group">
                <label for="tempRadiateur">Température de départ radiateurs (°C) :</label>
                <input type="number" id="tempRadiateur" name="tempRadiateur" min="40" max="90" value="70">
            </div>
        </div>
        
        <div id="plancher-params" class="conditional-section" style="display: none;">
            <div class="form-group">
                <label for="tempPlancher">Température de départ plancher (°C) :</label>
                <input type="number" id="tempPlancher" name="tempPlancher" min="25" max="45" value="35">
            </div>
        </div>
        
        <div class="form-actions">
            <button type="button" onclick="window.calcule()">Calculer</button>
            <button type="reset">Réinitialiser</button>
        </div>
    </form>
    
    <div id="resultats" class="results-container">
        <h3>Résultats</h3>
        <div class="result-item">
            <span class="result-label">Puissance nécessaire :</span>
            <span id="puissance-result" class="result-value">-- kW</span>
        </div>
        <div class="result-item">
            <span class="result-label">Puissance par m² :</span>
            <span id="puissance-m2-result" class="result-value">-- W/m²</span>
        </div>
    </div>
</div>

<script>
    // Script spécifique au module
    function initializePuissanceChauffage() {
        console.log("Module de puissance chauffage initialisé");
        
        // Initialisation des éléments conditionnels
        document.querySelectorAll('input[name="typeEmetteur"]').forEach(radio => {
            radio.addEventListener('change', function () {
                document.getElementById('radiateur-params').style.display = 
                    this.value === 'radiateur' ? 'block' : 'none';
                document.getElementById('plancher-params').style.display = 
                    this.value === 'plancher' ? 'block' : 'none';
            });
        });
        
        // Lancer un premier calcul au chargement
        calcule();
    }

    // Fonction de calcul
    function calcule() {
        // Récupération des valeurs
        const surface = parseFloat(document.getElementById('surface').value) || 0;
        const hauteur = parseFloat(document.getElementById('hauteur').value) || 0;
        const isolation = document.getElementById('isolation').value;
        const zone = document.getElementById('zone').value;
        const typeEmetteur = document.querySelector('input[name="typeEmetteur"]:checked').value;
        
        // Coefficients selon l'isolation
        const coeffIsolation = {
            'excellente': 25,
            'bonne': 35,
            'moyenne': 45,
            'faible': 60
        };
        
        // Coefficients selon la zone
        const coeffZone = {
            'H1': 1.2,
            'H2': 1.0,
            'H3': 0.8
        };
        
        // Calcul de la puissance
        let puissance = surface * coeffIsolation[isolation] * coeffZone[zone];
        
        // Ajustement selon le type d'émetteur
        if (typeEmetteur === 'plancher') {
            puissance *= 0.9; // Le plancher chauffant est plus efficace
        }
        
        // Conversion en kW
        puissance = puissance / 1000;
        
        // Affichage des résultats
        document.getElementById('puissance-result').textContent = puissance.toFixed(1) + ' kW';
        document.getElementById('puissance-m2-result').textContent = (puissance * 1000 / surface).toFixed(0) + ' W/m²';
    }
    
    // Si le module est chargé directement (pas via l'application principale)
    if (typeof window.initializeModule !== 'function') {
        initializePuissanceChauffage();
    }
</script>
