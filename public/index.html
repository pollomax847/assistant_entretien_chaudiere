<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chauffage Expert</title>
    <link rel="stylesheet" href="css/theme.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <!-- html2pdf.js via CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Chauffage Expert</h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#module-puissance-chauffage"><img src="assets/icons/power_calculation.svg" alt=""> Puissance Chauffage</a></li>
                    <li><a href="#module-vase-expansion"><img src="assets/icons/maintenance.svg" alt=""> Vase d'Expansion</a></li>
                    <li><a href="#module-equilibrage"><img src="assets/icons/compliance.svg" alt=""> Équilibrage Réseau</a></li>
                    <li><a href="#module-radiateurs"><img src="assets/icons/maintenance.svg" alt=""> Radiateurs</a></li>
                    <li><a href="#module-ecs"><img src="assets/icons/power_calculation.svg" alt=""> ECS Instantané</a></li>
                    <li><a href="#module-top-gaz"><img src="assets/icons/power_calculation.svg" alt=""> Top Compteur Gaz</a></li>
                    <li><a href="#module-vmc"><img src="assets/icons/compliance.svg" alt=""> VMC</a></li>
                    <li><a href="#module-reglementation-gaz"><img src="assets/icons/compliance.svg" alt=""> Réglementation Gaz</a></li>
                    <li><a href="#module-reglementaires-comp"><img src="assets/icons/compliance.svg" alt=""> Autres Vérifications</a></li>
                    <li><a href="#module-export-pdf"><img src="assets/icons/maintenance.svg" alt=""> Export PDF</a></li>
                    <li><a href="#module-preferences"><img src="assets/icons/maintenance.svg" alt=""> Préférences</a></li>
                    <!-- Add other modules later -->
                </ul>
            </nav>
            <div class="sidebar-footer">
                <span id="status-indicator" title="Statut de la connexion">⚫</span>
                <span id="technician-name"></span>
            </div>
        </aside>

        <main class="main-content">
            <header class="main-header">
                <h1>Tableau de bord</h1>
                <input type="search" id="search-modules" placeholder="Rechercher un module...">
            </header>

            <section id="module-puissance-chauffage" class="module-section">
                <h2>1. Calcul de Puissance Chauffage</h2>
                <p>Estimez la puissance nécessaire pour chauffer un volume donné.</p>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="chauffage-surface">Surface au sol (m²)</label>
                        <input type="number" id="chauffage-surface" placeholder="Ex: 50">
                    </div>
                    <div class="form-group">
                        <label for="chauffage-hauteur">Hauteur sous plafond (m)</label>
                        <input type="number" id="chauffage-hauteur" value="2.5" placeholder="Ex: 2.5">
                    </div>
                    <div class="form-group">
                        <label for="chauffage-temp-int">Température intérieure souhaitée (°C)</label>
                        <input type="number" id="chauffage-temp-int" value="20" placeholder="Ex: 20">
                    </div>
                    <div class="form-group">
                        <label for="chauffage-temp-ext">Température extérieure de base (°C)</label>
                        <input type="number" id="chauffage-temp-ext" value="-5" placeholder="Ex: -5">
                    </div>
                    <div class="form-group">
                        <label for="chauffage-coef-g">Coefficient G (Isolation)</label>
                        <select id="chauffage-coef-g">
                            <option value="1.5">Mauvaise (avant 1974)</option>
                            <option value="1.1" selected>Moyenne (1974-1990)</option>
                            <option value="0.9">Bonne (1990-2005)</option>
                            <option value="0.7">Très Bonne (RT2005/2012)</option>
                            <option value="0.5">Excellente (Passive)</option>
                        </select>
                    </div>
                </div>
                <div class="result-box" id="result-puissance-chauffage">
                    <!-- Results will be displayed here -->
                    <p>Volume calculé : <strong id="chauffage-volume">--</strong> m³</p>
                    <p>Delta T (ΔT) : <strong id="chauffage-delta-t">--</strong> °C</p>
                    <p><strong>Puissance requise : <strong id="chauffage-puissance">--</strong> kW</strong></p>
                </div>
            </section>

            <section id="module-vase-expansion" class="module-section">
                <h2>2. Calcul Vase d'Expansion</h2>
                <p>Déterminez la pression de gonflage et le réglage initial du vase.</p>
                 <div class="form-grid">
                    <div class="form-group">
                        <label for="vase-hauteur">Hauteur statique (m)</label>
                        <input type="number" id="vase-hauteur" placeholder="Hauteur entre vase et radiateur le + haut">
                    </div>
                    <div class="form-group">
                        <label for="vase-radiateur-loin">Radiateur le plus éloigné > 15m ?</label>
                        <select id="vase-radiateur-loin">
                            <option value="non" selected>Non</option>
                            <option value="oui">Oui</option>
                        </select>
                    </div>
                </div>
                 <div class="result-box" id="result-vase-expansion">
                    <p>Pression de gonflage : <strong id="vase-pression">--</strong> bar</p>
                    <p>Réglage disconnecteur : <strong id="vase-reglage">--</strong> tours</p>
                </div>
                <!-- Placeholder for 3D visual -->
                <div id="vase-visual"></div>
            </section>

            <section id="module-equilibrage" class="module-section">
                <h2>3. Équilibrage Réseau</h2>
                <p>Calculez le réglage des robinets pour équilibrer le réseau.</p>
                <div class="form-group">
                    <label>Méthode de réglage :</label>
                    <div class="radio-group">
                        <label><input type="radio" name="equilibrage-methode" value="puissance" checked> Par Puissance/Débit</label>
                        <label><input type="radio" name="equilibrage-methode" value="deltaT"> Par Delta T</label>
                    </div>
                </div>
                <div id="equilibrage-puissance-inputs">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="equilibrage-puissance">Puissance du radiateur (W)</label>
                            <input type="number" id="equilibrage-puissance" placeholder="Ex: 1500">
                        </div>
                        <div class="form-group">
                            <label for="equilibrage-debit">Débit nominal du robinet (L/h à 1 bar)</label>
                            <input type="number" id="equilibrage-debit" placeholder="Voir doc fabricant">
                        </div>
                    </div>
                </div>
                 <div id="equilibrage-deltaT-inputs" style="display: none;">
                    <p class="info-message">Le calcul par Delta T n'est pas encore disponible. Utilisez la méthode par Puissance/Débit.</p>
                </div>
                <div class="result-box" id="result-equilibrage">
                    <p>Réglage du robinet : <strong id="equilibrage-reglage">--</strong> tours</p>
                </div>
            </section>

            <section id="module-radiateurs" class="module-section">
                <h2>4. Puissance Radiateur</h2>
                <p>Estimez la puissance d'un radiateur existant.</p>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="rad-type">Type de radiateur</label>
                        <select id="rad-type">
                            <option value="Acier">Acier Classique</option>
                            <option value="Fonte">Fonte</option>
                            <option value="Aluminium">Aluminium</option>
                            <option value="FonteAlu">Fonte d'Aluminium</option>
                            <option value="Panneaux">Panneaux Acier</option>
                            <option value="SecheServiette">Sèche-Serviette</option>
                        </select>
                    </div>
                     <div class="form-group" id="rad-panel-type-group" style="display: none;">
                        <label for="rad-panel-type">Type de panneau</label>
                        <select id="rad-panel-type">
                            <option value="T11">Type 11 (1+1)</option>
                            <option value="T21">Type 21 (2+1)</option>
                            <option value="T22">Type 22 (2+2)</option>
                            <option value="T33">Type 33 (3+3)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="rad-hauteur">Hauteur (cm)</label>
                        <input type="number" id="rad-hauteur" placeholder="Ex: 60">
                    </div>
                    <div class="form-group">
                        <label for="rad-longueur">Longueur (cm)</label>
                        <input type="number" id="rad-longueur" placeholder="Ex: 100">
                    </div>
                </div>
                <div class="radiator-visual" id="rad-visual">
                    <!-- Visual will be loaded here -->
                    <img src="" alt="Visuel radiateur" style="display:none; max-width: 200px; margin-top: 10px;">
                </div>
                <div class="result-box" id="result-radiateur">
                    <p>Puissance estimée (ΔT 50K) : <strong id="rad-puissance">--</strong> W</p>
                </div>
            </section>

            <!-- Add other module sections later -->
             <section id="module-ecs" class="module-section">
                <h2>5. Analyse ECS Instantané</h2>
                <p>Vérifiez la production d'Eau Chaude Sanitaire.</p>
                <!-- Inputs for ECS -->
                 <div class="form-grid">
                    <div class="form-group">
                        <label for="ecs-temp-efs">Température Eau Froide (°C)</label>
                        <input type="number" id="ecs-temp-efs" value="10" placeholder="Ex: 10">
                    </div>
                    <div class="form-group">
                        <label for="ecs-temp-ecs">Température Eau Chaude (°C)</label>
                        <input type="number" id="ecs-temp-ecs" value="45" placeholder="Ex: 45">
                    </div>
                    <div class="form-group">
                        <label for="ecs-debit">Débit mesuré (L/min)</label>
                        <input type="number" id="ecs-debit" placeholder="Ex: 12">
                    </div>
                    <div class="form-group">
                        <label for="ecs-puissance-chaudiere">Puissance Chaudière (kW, facultatif)</label>
                        <input type="number" id="ecs-puissance-chaudiere" placeholder="Ex: 24">
                    </div>
                </div>
                <div class="result-box" id="result-ecs">
                    <p>Delta T (ΔT) : <strong id="ecs-delta-t">--</strong> °C</p>
                    <p>Puissance restituée : <strong id="ecs-puissance-restituee">--</strong> kW</p>
                    <p id="ecs-coherence" class="coherence-message"></p>
                </div>
            </section>

            <section id="module-top-gaz" class="module-section">
                <h2>6. Top Compteur Gaz</h2>
                <p>Mesurez la puissance réelle de l'appareil à gaz.</p>
                <!-- Inputs for Top Gaz -->
                 <div class="form-grid">
                     <div class="form-group form-group-digits">
                        <label>Derniers chiffres rouges du compteur</label>
                        <div class="digit-inputs">
                            <input type="number" id="gaz-digit1" min="0" max="9" placeholder="0">
                            <input type="number" id="gaz-digit2" min="0" max="9" placeholder="0">
                            <input type="number" id="gaz-digit3" min="0" max="9" placeholder="0">
                            <span>Litres</span>
                        </div>
                    </div>
                     <div class="form-group">
                        <label for="gaz-type">Type de Gaz (PCS)</label>
                        <select id="gaz-type">
                            <option value="9.6">Gaz Naturel (G20/G25 - PCS ≈ 9.6 kWh/m³)</option>
                            <option value="12.8">Propane (G31 - PCS ≈ 12.8 kWh/kg)</option>
                            <!-- Add Butane if needed -->
                        </select>
                    </div>
                     <div class="form-group">
                        <label>Durée du test</label>
                        <div class="radio-group">
                            <label><input type="radio" name="gaz-duree" value="36" checked> 36 secondes</label>
                            <label><input type="radio" name="gaz-duree" value="60"> 60 secondes</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="gaz-puissance-chaudiere">Puissance Chaudière (kW, facultatif)</label>
                        <input type="number" id="gaz-puissance-chaudiere" placeholder="Ex: 24">
                    </div>
                </div>
                <div class="result-box" id="result-top-gaz">
                    <p>Volume mesuré : <strong id="gaz-volume">--</strong> L</p>
                    <p>Débit horaire : <strong id="gaz-debit">--</strong> L/h</p>
                    <p>Puissance mesurée : <strong id="gaz-puissance">--</strong> kW</p>
                    <p id="gaz-coherence" class="coherence-message"></p>
                </div>
            </section>

             <section id="module-vmc" class="module-section">
                <h2>7. Vérification VMC</h2>
                <p>Contrôlez le bon fonctionnement de la Ventilation Mécanique Contrôlée.</p>
                <!-- Inputs for VMC -->
                 <div class="form-grid">
                    <div class="form-group">
                        <label for="vmc-type">Type de VMC</label>
                        <select id="vmc-type">
                            <option value="simple-auto">Simple Flux Auto</option>
                            <option value="simple-hygro-a">Simple Flux Hygro A</option>
                            <option value="simple-hygro-b">Simple Flux Hygro B</option>
                            <option value="double-flux">Double Flux</option>
                            <option value="gaz">VMC Gaz</option>
                            <!-- Add others like VTI, Sekoia if needed -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vmc-bouches">Nombre de bouches d'extraction</label>
                        <input type="number" id="vmc-bouches" placeholder="Ex: 4">
                    </div>
                    <div class="form-group">
                        <label for="vmc-debit-mh">Débit total mesuré (m³/h)</label>
                        <input type="number" id="vmc-debit-mh" placeholder="Ex: 120">
                    </div>
                    <div class="form-group">
                        <label for="vmc-debit-ms">Vitesse d'air bouche cuisine (m/s)</label>
                        <input type="number" id="vmc-debit-ms" placeholder="Ex: 1.5">
                    </div>
                    <div class="form-group">
                        <label for="vmc-modules-fenetres">Modules/Entrées d'air aux fenêtres conformes ?</label>
                        <select id="vmc-modules-fenetres">
                            <option value="oui">Oui</option>
                            <option value="non">Non</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vmc-etalonnage-portes">Étalonnage/Détalonnage des portes vérifié ?</label>
                        <select id="vmc-etalonnage-portes">
                            <option value="oui">Oui</option>
                            <option value="non">Non</option>
                        </select>
                    </div>
                </div>
                <div class="result-box" id="result-vmc">
                    <!-- VMC results -->
                </div>
            </section>

            <section id="module-reglementation-gaz" class="module-section">
                <h2>8. Réglementation Appareil à Gaz</h2>
                <p>Vérifiez la conformité de l'installation selon le type d'appareil.</p>
                <!-- Inputs for Gas Regulation -->
                 <div class="form-group">
                    <label for="gaz-reg-type-appareil">Type d'appareil</label>
                    <select id="gaz-reg-type-appareil">
                        <option value="">-- Sélectionner --</option>
                        <option value="A">Type A (Non raccordé)</option>
                        <option value="B">Type B (Raccordé cheminée)</option>
                        <option value="C">Type C (Étanche / Ventouse)</option>
                    </select>
                </div>
                <div id="gaz-reg-fields-A" class="gaz-reg-conditional" style="display:none;">
                    <p><strong>Type A :</strong> Vérifier ventilation haute et basse de la pièce.</p>
                    <!-- Add specific checks for Type A -->
                </div>
                 <div id="gaz-reg-fields-B" class="gaz-reg-conditional" style="display:none;">
                    <p><strong>Type B :</strong> Vérifier conduit de cheminée, amenée d'air, ROAI.</p>
                     <div class="form-group checkbox">
                        <input type="checkbox" id="gaz-reg-roai-b">
                        <label for="gaz-reg-roai-b">Présence Robinet ROAI</label>
                    </div>
                     <div class="form-group checkbox">
                        <input type="checkbox" id="gaz-reg-amenee-air-b">
                        <label for="gaz-reg-amenee-air-b">Amenée d'air directe/indirecte conforme</label>
                    </div>
                     <div class="form-group checkbox">
                        <input type="checkbox" id="gaz-reg-conduit-b">
                        <label for="gaz-reg-conduit-b">Conduit de fumée conforme (ramoné, non obstrué)</label>
                    </div>
                    <!-- Add specific checks for Type B -->
                </div>
                 <div id="gaz-reg-fields-C" class="gaz-reg-conditional" style="display:none;">
                    <p><strong>Type C :</strong> Vérifier terminal ventouse, distances.</p>
                     <div class="form-group">
                        <label for="gaz-reg-distance-c">Distance sortie aux ouvrants/vents dominants (m)</label>
                        <input type="number" id="gaz-reg-distance-c" placeholder="Ex: 0.4">
                    </div>
                    <!-- Add specific checks for Type C -->
                </div>
                <div class="result-box" id="result-reglementation-gaz">
                    <!-- Gas Regulation results -->
                </div>
                 <!-- Placeholder for visuals -->
                <div id="gaz-reg-visual"></div>
            </section>

            <section id="module-reglementaires-comp" class="module-section">
                <h2>9. Autres Vérifications Réglementaires</h2>
                <p>Points de contrôle essentiels pour la sécurité gaz.</p>
                <!-- Inputs for Other Checks -->
                <div class="sub-module">
                    <h4>Conformité Installation Gaz</h4>
                     <div class="form-group checkbox">
                        <input type="checkbox" id="comp-reglette-vaso">
                        <label for="comp-reglette-vaso">Réglette VASO présente et conforme</label>
                    </div>
                     <div class="form-group checkbox">
                        <input type="checkbox" id="comp-roai">
                        <label for="comp-roai">Robinet ROAI présent et accessible</label>
                    </div>
                     <div class="form-group checkbox">
                        <input type="checkbox" id="comp-distances">
                        <label for="comp-distances">Distances de sécurité respectées</label>
                    </div>
                    <div class="result-box" id="result-conformite-gaz-comp"></div>
                </div>
                 <div class="sub-module">
                    <h4>Ventilation Cuisine</h4>
                     <div class="form-group">
                        <label for="comp-hotte-type">Type de hotte</label>
                        <select id="comp-hotte-type">
                            <option value="aucune">Aucune</option>
                            <option value="passive">Passive / Statique</option>
                            <option value="motorisee">Motorisée</option>
                        </select>
                    </div>
                     <div class="form-group checkbox" id="comp-asservissement-group" style="display:none;">
                        <input type="checkbox" id="comp-asservissement">
                        <label for="comp-asservissement">Asservissement avec chaudière Type B présent</label>
                    </div>
                    <div class="result-box" id="result-ventilation-cuisine"></div>
                </div>
                 <div class="sub-module">
                    <h4>Évacuation des Fumées (si applicable)</h4>
                     <div class="form-grid">
                        <div class="form-group">
                            <label for="comp-evac-materiau">Matériau conduit</label>
                            <input type="text" id="comp-evac-materiau" placeholder="Ex: Inox, Alu, PVC">
                        </div>
                        <div class="form-group">
                            <label for="comp-evac-pente">Pente (%)</label>
                            <input type="number" id="comp-evac-pente" placeholder="Ex: 3">
                        </div>
                        <div class="form-group">
                            <label for="comp-evac-longueur">Longueur (m)</label>
                            <input type="number" id="comp-evac-longueur" placeholder="Ex: 5">
                        </div>
                        <div class="form-group">
                            <label for="comp-evac-coudes">Nombre de coudes</label>
                            <input type="number" id="comp-evac-coudes" placeholder="Ex: 2">
                        </div>
                    </div>
                    <div class="result-box" id="result-evacuation-fumees"></div>
                </div>
                 <div class="sub-module">
                    <h4>VMC Gaz (si applicable)</h4>
                     <div class="form-group checkbox">
                        <input type="checkbox" id="comp-vmc-gaz-dsc">
                        <label for="comp-vmc-gaz-dsc">DSC (Dispositif Sécurité Collective) présent et fonctionnel</label>
                    </div>
                     <div class="form-group checkbox">
                        <input type="checkbox" id="comp-vmc-gaz-test-co">
                        <label for="comp-vmc-gaz-test-co">Test CO ambiant OK</label>
                    </div>
                    <div class="result-box" id="result-vmc-gaz"></div>
                </div>
            </section>

            <section id="module-export-pdf" class="module-section">
                <h2>10. Export PDF</h2>
                <p>Générez un rapport d'intervention personnalisé.</p>
                <!-- Inputs for PDF Export -->
                 <div class="form-grid">
                    <div class="form-group">
                        <label for="pdf-client-name">Nom du Client</label>
                        <input type="text" id="pdf-client-name" placeholder="Nom Prénom">
                    </div>
                    <div class="form-group">
                        <label for="pdf-client-address">Adresse du Client</label>
                        <input type="text" id="pdf-client-address" placeholder="Numéro, Rue, Ville">
                    </div>
                    <div class="form-group form-group-full">
                        <label for="pdf-remarks">Remarques / Travaux effectués</label>
                        <textarea id="pdf-remarks" rows="4" placeholder="Détaillez l'intervention..."></textarea>
                    </div>
                </div>
                <h4>Modules à inclure dans le rapport :</h4>
                <div id="pdf-module-selection" class="checkbox-group">
                    <!-- Checkboxes will be populated by JS -->
                </div>
                <button id="btn-generate-pdf" class="btn btn-primary">Générer le PDF</button>
                <div id="pdf-preview-area" style="margin-top: 20px; border: 1px solid #ccc; padding: 10px; display: none;">
                    Prévisualisation PDF...
                </div>
            </section>

            <section id="module-preferences" class="module-section">
                <h2>11. Préférences</h2>
                <p>Personnalisez votre application.</p>
                <!-- Inputs for Preferences -->
                 <div class="form-grid">
                    <div class="form-group">
                        <label for="pref-technician-name">Prénom du Technicien</label>
                        <input type="text" id="pref-technician-name" placeholder="Votre prénom">
                    </div>
                    <div class="form-group">
                        <label for="pref-theme">Thème</label>
                        <select id="pref-theme">
                            <option value="light">Clair</option>
                            <option value="dark">Sombre</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pref-logo">Logo Entreprise (PNG/JPG)</label>
                        <input type="file" id="pref-logo" accept="image/png, image/jpeg">
                        <img id="pref-logo-preview" src="" alt="Aperçu logo" style="max-width: 150px; max-height: 50px; margin-top: 10px; display: none;">
                    </div>
                    <div class="form-group">
                        <label for="pref-units-temp">Unité Température</label>
                        <select id="pref-units-temp">
                            <option value="C">°C</option>
                            <option value="F">°F</option>
                        </select>
                    </div>
                </div>
                <button id="btn-save-prefs" class="btn btn-primary">Enregistrer les préférences</button>
            </section>

        </main>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
