import"./notifications-DM2bvA8y.js";document.addEventListener("DOMContentLoaded",()=>{g(),f(),I(),localStorage.getItem("sidebarHidden")==="true"&&appContainer.classList.add("sidebar-hidden"),B(),loadFavorites()});const m=[{id:"module-puissance-chauffage",title:"Puissance Chauffage",icon:"/assets/icons/calculator.svg",description:"Calcul de la puissance de chauffage nécessaire"},{id:"module-vase-expansion",title:"Vase d'Expansion",icon:"/assets/icons/water.svg",description:"Calcul et vérification du vase d'expansion"},{id:"module-equilibrage",title:"Équilibrage Réseau",icon:"/assets/icons/balance.svg",description:"Calculs d'équilibrage du réseau de chauffage"},{id:"module-radiateurs",title:"Radiateurs",icon:"/assets/icons/radiator.svg",description:"Calculs et vérifications des radiateurs"},{id:"module-ecs",title:"ECS Instantané",icon:"/assets/icons/water-drop.svg",description:"Calculs pour l'eau chaude sanitaire"},{id:"module-top-gaz",title:"Top Compteur Gaz",icon:"/assets/icons/gas.svg",description:"Vérification des compteurs de gaz"},{id:"module-vmc",title:"VMC",icon:"/assets/icons/ventilation.svg",description:"Calculs pour la ventilation mécanique"},{id:"module-reglementation-gaz",title:"Réglementation Gaz",icon:"/assets/icons/rules.svg",description:"Vérifications réglementaires gaz"},{id:"module-reglementaires-comp",title:"Autres Vérifications",icon:"/assets/icons/compliance.svg",description:"Vérifications réglementaires diverses"},{id:"module-export-pdf",title:"Export PDF",icon:"/assets/icons/pdf.svg",description:"Génération de rapports PDF"},{id:"module-preferences",title:"Préférences",icon:"/assets/icons/settings.svg",description:"Configuration de l'application"}];function g(){p(),o("module-puissance-chauffage"),C()}function f(){document.querySelectorAll(".sidebar-nav a").forEach(n=>{n.addEventListener("click",s=>{s.preventDefault();const i=s.currentTarget.getAttribute("href").substring(1);o(i)})}),document.getElementById("logoutBtn").addEventListener("click",x),document.getElementById("search-modules").addEventListener("input",d);const e=document.getElementById("sidebarToggle"),t=document.querySelector(".app-container");e.addEventListener("click",()=>{t.classList.toggle("sidebar-hidden");const n=t.classList.contains("sidebar-hidden");localStorage.setItem("sidebarHidden",n)})}function p(){const e=document.getElementById("status-indicator");navigator.onLine?(e.classList.add("status-online"),e.classList.remove("status-offline"),e.title="Connecté"):(e.classList.add("status-offline"),e.classList.remove("status-online"),e.title="Hors ligne")}function o(e){const t=document.getElementById("module-container");t.innerHTML="",fetch(`/modules/${e}.html`).then(n=>n.text()).then(n=>{t.innerHTML=n,v(e)}).catch(n=>{console.error("Erreur lors du chargement du module:",n),t.innerHTML='<div class="error">Erreur lors du chargement du module</div>'})}function v(e){switch(e){case"module-puissance-chauffage":h();break;case"module-vase-expansion":L();break}}function h(){const e=document.getElementById("puissance-chauffage-form");e&&e.addEventListener("submit",t=>{t.preventDefault(),E()})}function E(){const e=parseFloat(document.getElementById("surface").value),t=parseFloat(document.getElementById("hauteur").value),n=parseFloat(document.getElementById("temp-int").value),s=parseFloat(document.getElementById("temp-ext").value),i=parseFloat(document.getElementById("coefficient-g").value),a=e*t,r=n-s,u=i*a*r/1e3;c("puissance-result",{volume:a.toFixed(2),deltaT:r.toFixed(1),puissance:u.toFixed(2)})}function L(){const e=document.getElementById("vase-expansion-form");e&&e.addEventListener("submit",t=>{t.preventDefault(),b()})}function b(){const e=parseFloat(document.getElementById("hauteur-batiment").value),t=document.getElementById("radiateur-eloigne").checked,n=e/10+.3,s=Math.round(n*2)/2;c("vase-expansion-result",{pressionTheorique:n.toFixed(2),reglageTours:s.toFixed(1),radiateurEloigne:t?"Oui":"Non"})}function c(e,t){const n=document.getElementById(e);if(!n)return;let s='<div class="result">';for(const[i,a]of Object.entries(t))s+=`<p><strong>${y(i)}:</strong> ${a}</p>`;s+="</div>",n.innerHTML=s}function y(e){return{volume:"Volume (m³)",deltaT:"ΔT (°C)",puissance:"Puissance (kW)",pressionTheorique:"Pression théorique (bar)",reglageTours:"Réglage (tours)",radiateurEloigne:"Radiateur le plus éloigné"}[e]||e}function I(){const e=JSON.parse(localStorage.getItem("userPreferences"))||{};document.getElementById("technician-name").textContent=e.technicianName||"Technicien"}function C(){const e=document.getElementById("search-modules");e&&e.addEventListener("input",d)}function d(e){const t=e.target.value.toLowerCase();document.querySelectorAll(".sidebar-nav a").forEach(s=>{const i=s.textContent.toLowerCase();s.parentElement.style.display=i.includes(t)?"block":"none"})}function x(){localStorage.removeItem("userPreferences"),window.location.href="/auth.html"}function B(){const e=document.getElementById("modulesGrid");e.innerHTML="",m.forEach(t=>{const n=T(t);e.appendChild(n)})}function T(e){const t=document.createElement("div");t.className="module-card",t.dataset.moduleId=e.id;const n=l(e.id);return n&&t.classList.add("favorite"),t.innerHTML=`
        <div class="module-card-header">
            <div class="module-card-icon">
                <img src="${e.icon}" alt="${e.title}">
            </div>
            <button class="module-card-favorite ${n?"active":""}" data-module-id="${e.id}">
                <img src="/assets/icons/star.svg" alt="Favoris">
            </button>
        </div>
        <h3 class="module-card-title">${e.title}</h3>
        <p class="module-card-description">${e.description}</p>
    `,t.addEventListener("click",i=>{i.target.closest(".module-card-favorite")||o(e.id)}),t.querySelector(".module-card-favorite").addEventListener("click",i=>{i.stopPropagation(),S(e.id)}),t}function S(e){const t=JSON.parse(localStorage.getItem("favorites")||"[]"),n=t.indexOf(e);n===-1?t.push(e):t.splice(n,1),localStorage.setItem("favorites",JSON.stringify(t)),F(e)}function l(e){return JSON.parse(localStorage.getItem("favorites")||"[]").includes(e)}function F(e){const t=document.querySelector(`.module-card[data-module-id="${e}"]`),n=t.querySelector(".module-card-favorite"),s=l(e);t.classList.toggle("favorite",s),n.classList.toggle("active",s)}
